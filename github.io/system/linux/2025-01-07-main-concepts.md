---
layout: single
title: "[linux] 주요 개념 정리"
categories: system/linux
published: false
---

#### inline 함수

함수 호출 시 발생하는 오버로드를 줄여서 최적화

#### 프로세스

- 운영체제는 가상 프로세서와 가상 메모리를 제공함 => 프로세스는 혼자 시스템을 사용하는듯 함
- 커널은 프로세스를 struct task_struct로 나타내고, 리스트 형태로 관리함
- 프로세스 상태
  - TASK_RUNNING : cpu상에서 돌고 있거나 돌기 위해 대기하는 상태
  - TASK_INTERRUPTIBLE or TASK_UNINTERRUPTIBLE : 대기열로 이동해 휴면상태
- 모든 프로세스는 PID가 1일 init 프로세스의 자손임
- 리눅스 스레드 : 별도의 스레드 개념없이 기본적인 프로세스로모든 스레드르 구현(특정 자원을 다른 프로세스와 공유하는 특별한 프로세스 정도임)

#### 시스템 호출

- 커널이 하드웨어 인터페이스를 추상화하여 사용자 공간에 제공
- 프로세스별 가상 시스템 환경을 제공, 복잡한 내용은 숨김
- 애플리케이션이 하고 싶은 일을 마음대로 직접 할 수 없게 만들어 안정적인 시스템을 제공
- POSIX : 커널을 시스템 호출을 한 번 더 감싼 인터페이스(API) 중 가장 유명

#### 인터럽트와 인터럽트 핸들러

- 인터럽트가 발생하면 인터럽트 컨트롤러(여러 개의 인터럽트를 묶어서 관리)가 하여 프로세서에게 알려줌
- 프로세서는 실행하던 일을 중지하고 인터럽트 처리 루틴으로 들어감.

#### 루트파일시스템

- 파일시스템 계층 구조의 맨 위에 위치하여, "/"로 표시되는 최상위 디렉토리에 마운트되는 파일 시스템
- 모든 다른 파일과 디렉토리가 이 루트 파일 시스템 아래에 위치함
- 커널이미지, 부로더, 필수 실행파일, 설정 파일들을 포함하고 있음

#### 리눅스 부트과정

- BIOS/UEFI : 부팅 후, 시스템 파티션에서 부트로더를 읽어 메모리에 로드 후 제어권을 넘김
- 부트로더 (GRUP 또는 LILO) : 사용 가능한 운영체제 목록을 보여주거나, 커널이미지를 선택하고, 커널이미지와 initramfs(초기 RAM 디스크)파일을 메모리에 로드한 후 커널에게 제어권을 넘김
- 커널 : 하드웨어 초기화 수행, 초기 RAM 디스크를 임시 루트 파일 시스템으로 사용, 실제 루트 파일 시스템을 읽기 전용으로 마운트한 뒤, 마지막으로 init 시스템을 첫 번째 프로세스 (PID 1)로 실행
- Init 시스템 (Systemd) : 시스템 초기화 및 시스템 서비스/데몬을 정해진 순서대로 시작하고, 최종적으로 로그임 프롬프트를 표시하여 사용자가 시스템에 접그나도록 함

#### sysfs, debugfs, procfs

- `/proc` : 프로세스 파일 시스템
  - 프로세스 정보 및 CPU 정보, 메모리 사용량, 커널 버전등을 노출하는데 사용
  - `/proc/[PID]` 는 특정 프로세스 ID 에 대한 정보를 담고 있음
- `/sys` : 커널 객체를 구조화된 방식으로 노출하기 위해 만들어진 가상 파일 시스템
  - 리눅스 커널 객체 모델을 표현하고, 특히 디바이스, 드라이버, 버스와 관련된 정보를 구조적으로 노출함
  - 보통 `/sys` 에 마운트 됨
  - 파일당 하나의 값이라는 엄격한 규칙을 따름
  - `/sys/bus`, `/sys/class`, `/sys/devices`와 같은 하위 디렉토릴를 통해 세스템의 하드웨어 구성 요소를 명활하게 보여줌
- `/sys/kernel/debug` 또는 `/debug` : 커널 개발자를 위한 규칙이 적은 디버깅 전용 파일 시스템
  - 규칙이 없는 간단한 인터페이스를 제공함
  - procfs 나 sysfs 에서 제공하기 적절하지 않거나, 디버깅 용도로 임시정보를 노출하는데 사용

#### 프로파일링 도구

- htop(top의 상위버전 정도) : CPU 사용률, 메모리 사용량
- vmstat : 스왑 인/아웃 발생 여부(메모리 부족 징후), I/O 대기시간
- iostat : CPU와 디스크의 I/O 통계(사용률, 트랙잭션수)
- netstat : 네트워크 연결 상태 및 트래픽

#### 동기화 방법

- atomic : 해당 변수의 읽기, 수정, 쓰기 과정을 분할하지 못하게 하는 방법, 대신 32bit가 아닌 24bit을 사용함, 설정시 관련 함수를 써야함
- 스핀락 : 변수 하나가 아닌 작업 자체를 원자적으로 실행하고 싶을 경우 사용, 최대 하나의 스레드만 실행가능하며, 이미 사용중일때는 루프를 돌면서 락을 얻을 때까지 기다려야함. (열쇠를 가지고 문에 들어갔다가, 가지고 나와서 다음 사람에게 넘겨주는 형태), 프로세서 시간을 소모하기 때문에 오랫동안 잡으면 안됨. 단기간 락에만 사용해야함.
- 세마포어 : 휴면하는 락, 태스크가 기다리는 동안 휴면상태로 들어감, 열쇠가 여러개인 형태
- 뮤텍스 : 휴면하는 락, 열쇠가 하나임
